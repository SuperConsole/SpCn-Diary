{"componentChunkName":"component---src-templates-blog-post-js","path":"/041019/","webpackCompilationHash":"7f7bf81df24cbf981ffa","result":{"data":{"site":{"siteMetadata":{"title":"SpCn-Blog","author":"SuperConsole"}},"markdownRemark":{"id":"58ea0f97-669b-56a8-b1dc-2a193ff6dae5","excerpt":"Heartbleedというメモリリークから個人・機密情報を漏洩させる脆弱性。頑張ればこの脆弱性を持ったサーバーをイントラネットに立てて擬似攻撃できるんじゃね？って思ったのでやってみました。サーバーを立てるのにdockerを使い、コンテナイメージはhmlio/vaas-cve-2014-0160\nを使用します(VaaS…","html":"<p>Heartbleedというメモリリークから個人・機密情報を漏洩させる脆弱性。頑張ればこの脆弱性を持ったサーバーをイントラネットに立てて擬似攻撃できるんじゃね？って思ったのでやってみました。サーバーを立てるのにdockerを使い、コンテナイメージは<a href=\"https://hub.docker.com/r/hmlio/vaas-cve-2014-0160/\">hmlio/vaas-cve-2014-0160\n</a>を使用します(VaaSなんて言葉があるのな…)。以下に手順記載しますー  </p>\n<p>1.dockerで<a href=\"https://hub.docker.com/r/hmlio/vaas-cve-2014-0160/\">hmlio/vaas-cve-2014-0160</a>をプル  </p>\n<p>2.ポート(usageに書いてあったので8443にした)を指定して起動(dockerhub内の手順に従った。このコンテナが被害者側)  </p>\n<p>2’.nmapのHeartbleed検知スクリプトを使って被害者側が脆弱性を持つか確認)  </p>\n<p>3.攻撃者側(Kali Linux)でMetasploitを起動  </p>\n<p>4.CVE番号で検索をかけてHeartbleedモジュールを使用  </p>\n<p>5.オプションをいくつか設定して実行(RHOST, RPORT, VERBOSEの三つを設定した)  </p>\n<p>6.被害者側のメモリがリークしたのを確認できた。  </p>\n<p>ちなみに、HeartbleedはOpenSSLで暗号化通信をしていても通信の末端では復号してメモリに展開されているという隙をついた脆弱性です。もともとは接続確認とか応答の意味を兼ねてパケットをとんぼ返りするHeartbeatパケットというのがあり、その中のLengthというパケットの大きさを返すパラメータに実際の大きさを超える値をセットし、偽装した大きさと実際の大きさの差分だけメモリがリークする仕組みだ。JVNのデータを見るとOpenSSLはv1.0.1~v1.0.1fまでとのこと。執筆時点での最新版がv3.0.0なのでアップデートしていれば心配することはない。ただ、2014年に見つかったこの脆弱性は2016年ごろまで被害が起きていたことからユーザのインシデント対応の遅さが問題に繋がる原因ともなるので注意が必要です。</p>\n<p>うーん、それにしてもただただマニュアル読んでその通りにしただけでは？スクリプトキディみたい…。でもそれだけツールが充実しているということですね。手順がかなり端折っているのは詳しく書きすぎるとクラッキングの助長になってしまうかなと思ったからです。たぶんこの記事を読んだだけでクラッキングができたら元から知ってたよね？くらいの抽象度合いなので大目にみてくださいー。あ、このコンテナでOpenSSLをアップデートして脆弱性が解消されてるか確認しようとしたけどアップデートができなかった…脆弱性確認用だから対策されてるのかな…?おわり。</p>\n<p>参考:<br>\n<a href=\"https://jvndb.jvn.jp/ja/contents/2014/JVNDB-2014-001920.html\">JVNDB-2014-001920\n</a><br>\n<a href=\"https://www.lac.co.jp/lacwatch/people/20161013_001056.html\">え？今さらHeartBleedの話ですか？</a></p>","frontmatter":{"title":"Metasploit+docker(+nmap)で試すHeartbleed","date":"April 10, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/041019/","previous":{"fields":{"slug":"/190608/"},"frontmatter":{"title":"Metasploit+docker(+nmap)で試すHeartbleed"}},"next":null}}}